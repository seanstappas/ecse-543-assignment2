\documentclass[a4paper,titlepage]{article}
\usepackage[utf8]{inputenc}
\usepackage{fullpage}
\usepackage{indentfirst}
\usepackage[per-mode=symbol]{siunitx}
\usepackage{listings}
\usepackage{graphicx}
\usepackage{color}
\usepackage{amsmath}
\usepackage{array}
\usepackage[hidelinks]{hyperref}
\usepackage[format=plain,font=it]{caption}
\usepackage{subcaption}
\usepackage{standalone}
\usepackage[nottoc]{tocbibind}
\usepackage[noabbrev,capitalize,nameinlink]{cleveref}
\usepackage{listings}
\usepackage{titlesec}
\usepackage{minted}
\usepackage{booktabs}
\usepackage{csvsimple}
\usepackage{siunitx}
\usepackage[super]{nth}
\usepackage[titletoc]{appendix}

% Custom commands
\newcommand\numberthis{\addtocounter{equation}{1}\tag{\theequation}}
\newcommand{\code}[1]{\texttt{#1}}
\newcolumntype{P}[1]{>{\centering\arraybackslash}p{#1}}

\setminted{linenos,breaklines,fontsize=auto}

%\titleformat*{\section}{\normalsize\bfseries}
%\titleformat*{\subsection}{\small\bfseries}
\renewcommand{\thesubsection}{\thesection.\alph{subsection}}
\providecommand*{\listingautorefname}{Listing}
\newcommand*{\Appendixautorefname}{Appendix}

%opening
\title{\textbf{ECSE 543 \\ Assignment 2}}
\author{Sean Stappas \\ 260639512}
\date{November \nth{13}, 2017}

\begin{document}
	\sloppy
	\maketitle
	
	\tableofcontents
	
	
	\twocolumn
	
	\section*{Introduction}
	
	\section{Finite Element Triangles}
	
	The equation for the $\alpha$ parameter for a general vertex $i$ of a finite element triangle can be seen in \cref{eq:alpha}, where $i+1$ and $i+2$ implicitly wraps around when exceeding 3.
	
	\begin{equation} \label{eq:alpha}
		\begin{split}
			\alpha_i(x, y) = \frac{1}{2A} \big[
			& (x_{i+1}y_{i+2} - x_{i+2}y_{i+1}) \\
			& + (y_{i+1} - y_{i+2})x \\
			& + (x_{i+2} - x_{i+1})y \big]
		\end{split}
	\end{equation}
	
	Using \cref{eq:alpha}, we can solve for the entries of the local $S$ matrix, as shown in \cref{eq:local_s}. This was used in the program to compute every entry for both example triangles.
	
	\begin{equation} \label{eq:local_s}
		\begin{split}
			S_{ij} 
			= &\int\displaylimits_{\Delta_e}\nabla\alpha_i\cdot\nabla\alpha_j dS \\
			= &\frac{1}{4A} \big[ (y_{i+1} - y_{i+2})(y_{j+1} - y_{j+2}) \\
			&+ (x_{i+2} - x_{i+1})(x_{j+2} - x_{j+1})
			\big]
		\end{split}
	\end{equation}
	
	The local $S$ matrix for the first triangle can be seen in \cref{eq:local_s1}.
	
	\begin{equation} \label{eq:local_s1}
		S_1 =
			\begin{bmatrix}
				0.5  & -0.5 & 0 \\
				-0.5 & 1    & -0.5 \\
				0    & -0.5 & 0.5 
			\end{bmatrix}
	\end{equation}
	
	The local $S$ matrix for the second triangle can be seen in \cref{eq:local_s2}.
	
	\begin{equation} \label{eq:local_s2}
		S_2 =
			\begin{bmatrix}
				1    & -0.5 & -0.5 \\
				-0.5 & 0.5  & 0 \\
				-0.5 & 0    & 0.5 
			\end{bmatrix}
	\end{equation}
	
	The disjoint $S$ matrix is then given in \cref{eq:local_s2}.
	
	% TODO: fix formatting.
	
	\begin{equation} \label{eq:disjoint_s}
		S_{dis} =
		\begin{bmatrix}
		0.5  & -0.5  & 0     & 0     &  0    & 0     \\
		-0.5 & 1     & -0.5  & 0     &  0    & 0     \\
		0    & -0.5  & 0.5   & 0     &  0    & 0     \\
		0    & 0     & 0     & 1     & -0.5  & -0.5 \\
		0    & 0     & 0     & -0.5  & 0.5   & 0 \\
		0    & 0     & 0     & -0.5  & 0     & 0.5 \\
		\end{bmatrix}
	\end{equation}
	
	The global matrix $S$ is then given by \cref{eq:global_s}, where 
	
	\begin{equation} \label{eq:global_s}
		S = C^T S_{dis} C^T
	\end{equation}
	
	\section{Finite Element Coaxial Cable}
	
	\subsection{Mesh}
	
	\subsection{Electrostatic Potential}
	
	\subsection{Capacitance}
	
	The finite element functional equation can be seen in \cref{eq:functional}.
	
	\begin{equation} \label{eq:functional}
		W = \frac{1}{2} U_{con}^T S U_{con}
	\end{equation}
	
	The goal of the finite element method is to minimize $W$ to minimize the energy. However, $W$ is not equal to the energy. The relation between the energy per unit length $E$ and $W$ is shown in \cref{eq:energy}.
	
	\begin{equation} \label{eq:energy}
		E = \epsilon_0 W
	\end{equation}
	
	We then know that the energy per unit length $E$ is related to the capacitance per unit length $C$ as shown in \cref{eq:energy_capacitor}.
	
	\begin{equation} \label{eq:energy_capacitor}
		E = \frac{1}{2} C V^2
	\end{equation}
	
	Combining \cref{eq:functional,eq:energy,eq:energy_capacitor}, we obtain an expression for the capacitance per unit length which can be easily calculated, as shown in \autoref{eq:capacitance}.
	
	\begin{equation} \label{eq:capacitance}
		C = \frac{\epsilon_0 U_{con}^T S U_{con}}{V^2}
	\end{equation}
	
	\section{Conjugate Gradient Coaxial Cable}
	
	\subsection{Positive Definite Test}
	
	If the matrix $A$ is not positive definite, one can simply multiply both sides of the $Ax = b$ equation by $A^T$, forming a new equation $A^TAx = A^Tb$. This is equivalent to $A'x = b'$, where $b' = A^Tb$ and $A' = A^TA$. Here, $A'$ is now positive definite.
	
	\subsection{Matrix Solution}
	
	\subsection{Residual Norm}
	
	Consider a vector $\textbf{v} = \{v_1, \ldots, v_n\}$. The infinity norm $\|\textbf{v}\|_\infty$ of $\textbf{v}$ is given by the maximum absolute element of $\textbf{v}$, as shown in \cref{eq:infinity_norm}.
	
	\begin{equation} \label{eq:infinity_norm}
		\|\textbf{v}\|_\infty = \max\{|v_1|, \ldots, |v_n|\}
	\end{equation}
	
	Similarly, the 2-norm $\|\textbf{v}\|_2$ of $\textbf{v}$ is given by \cref{eq:2_norm}.
	
	\begin{equation} \label{eq:2_norm}
		\|\textbf{v}\|_2 = \sqrt{\sum_{i = 1}^{n} v_i^2}
	\end{equation}
	
	\subsection{Potential Comparison}
	
	\subsection{Capacitance Improvement}
	
%	\begin{figure}[!htb]
%		\centering
%		\includegraphics[width=0.5\columnwidth]{plots/q1_circuit_1.pdf}
%		\caption
%		{Test circuit 1 with labeled nodes.}
%		\label{fig:q1_circuit_1}
%	\end{figure}
%
%	\begin{table}[!htb]
%		\centering
%		\caption{Voltage at labeled nodes of circuit 1.}
%		\csvautobooktabular{csv/q1_circuit_1.csv}
%		\label{table:q1_circuit_1}
%	\end{table}
	
	\onecolumn
	
	\begin{appendices}
		
		\section{Code Listings} \label{appendix:code}
		
		\setminted{linenos,breaklines,fontsize=\footnotesize}
		
%		\begin{center}
%			\captionof{listing}{Custom matrix package (\texttt{matrices.py}).}
%			\inputminted{python}{../matrices.py}
%			\label{lst:matrices}
%		\end{center}
		
		\section{Output Logs} \label{appendix:logs}
		
%		\begin{center}
%			\captionof{listing}{Output of Question 1 program (\texttt{q1.txt}).}
%			\inputminted{pycon}{logs/q1.txt}
%			\label{lst:q1_log}
%		\end{center}

	\end{appendices}

\end{document}
